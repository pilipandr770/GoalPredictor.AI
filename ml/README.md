# ü§ñ ML –ú–æ–¥—É–ª—å GoalPredictor.AI

–ú–æ–¥—É–ª—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—É—Ç–±–æ–ª—å–Ω—ã—Ö –º–∞—Ç—á–µ–π —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ **Over 2.5 –≥–æ–ª–æ–≤**.

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–¥–µ–ª–µ–π

### –≠–≤–æ–ª—é—Ü–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏:

| –í–µ—Ä—Å–∏—è | –ê–ª–≥–æ—Ä–∏—Ç–º | –î–∞–Ω–Ω—ã–µ | –ü—Ä–∏–∑–Ω–∞–∫–∏ | Accuracy | AUC | –£–ª—É—á—à–µ–Ω–∏–µ |
|--------|----------|--------|----------|----------|-----|-----------|
| v1.0 | LightGBM | 975 | 29 | 52.31% | 52.56% | - |
| **v2.0** | **–ê–Ω—Å–∞–º–±–ª—å (4 –º–æ–¥–µ–ª–∏)** | **2140** | **58** | **68.69%** | **81.14%** | **+31.3%** üöÄ |

### üèÜ –õ—É—á—à–∏–µ –º–æ–¥–µ–ª–∏ –≤ –∞–Ω—Å–∞–º–±–ª–µ v2.0:

1. **Random Forest: 71.50%** (AUC 80.30%)
2. **CatBoost: 70.09%** (AUC 81.47%)
3. **XGBoost: 69.63%** (AUC 80.60%)
4. **LightGBM: 69.39%** (AUC 80.06%)

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è

```
ml/
‚îú‚îÄ‚îÄ model.py                    # –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å LightGBM (v1.0)
‚îú‚îÄ‚îÄ train.py                    # –û–±—É—á–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–π –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ download_data.py            # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ —Å Kaggle (2024-2025)
‚îú‚îÄ‚îÄ download_enhanced_data.py   # –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ advanced_features.py        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 58 –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
‚îú‚îÄ‚îÄ train_ensemble.py           # –û–±—É—á–µ–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª—è –∏–∑ 4 –º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ compare_models.py           # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ test_predictions.py         # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤
‚îî‚îÄ‚îÄ models/                     # –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
    ‚îú‚îÄ‚îÄ goal_predictor_model_*.pkl      # –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å v1.0
    ‚îî‚îÄ‚îÄ ensemble_model_*.pkl            # –ê–Ω—Å–∞–º–±–ª—å v2.0
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```bash
# –ë–∞–∑–æ–≤—ã–π –¥–∞—Ç–∞—Å–µ—Ç (Kaggle 2024-2025, —Ç–æ–ø-5 –ª–∏–≥)
python ml/download_data.py

# –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç (Premier League 2002-2022, –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)
python ml/download_enhanced_data.py
```

### 2. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

```bash
# –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å v1.0 (LightGBM)
python ml/train.py

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
python ml/advanced_features.py

# –û–±—É—á–µ–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª—è v2.0 (4 –º–æ–¥–µ–ª–∏)
python ml/train_ensemble.py
```

### 3. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –°—Ä–∞–≤–Ω–∏—Ç—å –≤—Å–µ –º–æ–¥–µ–ª–∏
python ml/compare_models.py

# –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≥–Ω–æ–∑—ã
python ml/test_predictions.py
```

## üéØ –ü—Ä–∏–∑–Ω–∞–∫–∏ –º–æ–¥–µ–ª–µ–π

### –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å v1.0 (29 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤):

- –°—Ä–µ–¥–Ω–∏–µ –≥–æ–ª—ã (–∑–∞–±–∏—Ç—ã–µ/–ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ)
- –ü—Ä–æ—Ü–µ–Ω—Ç Over 2.5 –∏ BTTS
- –§–æ—Ä–º–∞ –∫–æ–º–∞–Ω–¥ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –º–∞—Ç—á–µ–π)
- –î–æ–º–∞—à–Ω–∏–µ/–≤—ã–µ–∑–¥–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
- –ó–∞—â–∏—Ç–∞ (clean sheets)
- –õ–∏–≥–∞ –∏ –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏

### –ê–Ω—Å–∞–º–±–ª—å v2.0 (58 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤):

**Rolling averages (–æ–∫–Ω–∞: 3, 5, 10 –º–∞—Ç—á–µ–π):**
- –ì–æ–ª—ã –∑–∞–±–∏—Ç—ã–µ/–ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ
- –£–¥–∞—Ä—ã –∏ —É–¥–∞—Ä—ã –≤ —Å—Ç–≤–æ—Ä
- –ö–æ—Ä–Ω–µ—Ä—ã
- –§–æ–ª—ã
- –ñ–µ–ª—Ç—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏

**Head-to-head:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Å—Ç—Ä–µ—á
- –°—Ä–µ–¥–Ω–∏–µ –≥–æ–ª—ã –≤ –ª–∏—á–Ω—ã—Ö –≤—Å—Ç—Ä–µ—á–∞—Ö
- –ü—Ä–æ—Ü–µ–Ω—Ç Over 2.5 –≤ –ª–∏—á–Ω—ã—Ö –≤—Å—Ç—Ä–µ—á–∞—Ö

**–í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:**
- –î–µ–Ω—å –Ω–µ–¥–µ–ª–∏
- –ú–µ—Å—è—Ü
- –í—ã—Ö–æ–¥–Ω–æ–π/–±—É–¥–Ω–∏–π –¥–µ–Ω—å
- –ü—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–π —Å–µ–∑–æ–Ω

**–§–æ—Ä–º–∞ –∫–æ–º–∞–Ω–¥—ã (–∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞):**
- Form Points (–æ—á–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –º–∞—Ç—á–∏)
- Win/Loss Streaks (—Å–µ—Ä–∏–∏ –ø–æ–±–µ–¥/–ø–æ—Ä–∞–∂–µ–Ω–∏–π)
- Goal Difference (—Ä–∞–∑–Ω–∏—Ü–∞ –∑–∞–±–∏—Ç—ã—Ö/–ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö)

**–†–∞—Å—á–µ—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:**
- –û–∂–∏–¥–∞–µ–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ–ª–æ–≤
- –ê—Ç–∞–∫—É—é—â–∞—è —Å–∏–ª–∞
- –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ—Å—Ç—å (—Ñ–æ–ª—ã + –∫–∞—Ä—Ç–æ—á–∫–∏)

## üìà –î–∞—Ç–∞—Å–µ—Ç—ã

### 1. –ë–∞–∑–æ–≤—ã–π (Kaggle 2024-2025)

- **–ò—Å—Ç–æ—á–Ω–∏–∫:** `tarekmasryo/football-matches-20242025-top-5-leagues`
- **–ú–∞—Ç—á–∏:** 1941
- **–õ–∏–≥–∏:** Premier League, La Liga, Bundesliga, Serie A, Ligue 1
- **–ü–µ—Ä–∏–æ–¥:** 2024-2025 —Å–µ–∑–æ–Ω
- **–ö–æ–ª–æ–Ω–∫–∏:** 23

### 2. –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π (Premier League)

- **–ò—Å—Ç–æ—á–Ω–∏–∫:** `saife245/english-premier-league`
- **–ú–∞—Ç—á–∏:** 22,883
- **–ü–µ—Ä–∏–æ–¥:** 2000-2022
- **–ö–æ–ª–æ–Ω–∫–∏:** 196 (–¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)
- **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:** –£–¥–∞—Ä—ã, –∫–æ—Ä–Ω–µ—Ä—ã, –∫–∞—Ä—Ç–æ—á–∫–∏, —Ñ–æ–ª—ã, –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –±—É–∫–º–µ–∫–µ—Ä–æ–≤

### 3. European Football Database

- **–ò—Å—Ç–æ—á–Ω–∏–∫:** `hugomathien/soccer`
- **–§–æ—Ä–º–∞—Ç:** SQLite (32.7 MB)
- **–°–æ–¥–µ—Ä–∂–∏—Ç:** –î–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –µ–≤—Ä–æ–ø–µ–π—Å–∫–∏—Ö –ª–∏–≥

## üé≤ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

### –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å v1.0

```python
from ml.model import GoalPredictorModel

model = GoalPredictorModel()
model.load_model()  # –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –º–æ–¥–µ–ª—å

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–∞–Ω–¥
home_stats = {
    'avg_goals_scored': 1.8,
    'avg_goals_conceded': 1.2,
    'over_2_5_percentage': 0.6,
    'btts_percentage': 0.55,
    'last_5_form': 'WWLDW',
    # ... –¥—Ä—É–≥–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
}

away_stats = {
    # ... –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ
}

match_info = {
    'date': datetime.now(),
    'league': 'Premier League'
}

# –ü—Ä–æ–≥–Ω–æ–∑
prediction = model.predict(home_stats, away_stats, match_info)
print(f"Over 2.5: {prediction['probability']:.1%}")
print(f"–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: {prediction['recommendation']}")
```

### –ê–Ω—Å–∞–º–±–ª—å v2.0

```python
from ml.train_ensemble import EnsembleGoalPredictor

ensemble = EnsembleGoalPredictor()
ensemble.load_ensemble('ml/models/ensemble_model_20251005_223748.pkl')

# –ü—Ä–∏–∑–Ω–∞–∫–∏ (58 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)
features = {
    'home_goals_scored_last_3': 1.67,
    'home_goals_conceded_last_3': 1.0,
    'away_goals_scored_last_5': 1.4,
    # ... –≤—Å–µ 58 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
}

# –ü—Ä–æ–≥–Ω–æ–∑
prediction = ensemble.predict(features)
print(f"–ê–Ω—Å–∞–º–±–ª—å: {prediction['ensemble_proba']:.1%}")
print(f"–ü—Ä–æ–≥–Ω–æ–∑: {prediction['prediction']}")
print(f"–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {prediction['confidence']}")

# –ü—Ä–æ–≥–Ω–æ–∑—ã –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
for model_name, proba in prediction['individual_predictions'].items():
    print(f"  {model_name}: {proba:.1%}")
```

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –£—Ä–æ–≤–Ω–∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏:

- **> 75%:** –í—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (strong bet) üî•
- **60-75%:** –°—Ä–µ–¥–Ω—è—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (moderate bet) ‚úÖ
- **50-60%:** –ù–∏–∑–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (risky bet) ‚ö†Ô∏è
- **< 50%:** –°—Ç–∞–≤–∫–∞ –ø—Ä–æ—Ç–∏–≤ Over 2.5 ‚ùå

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å—Ç–∞–≤–æ–∫:

1. **–ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–∞—è:** –¢–æ–ª—å–∫–æ –ø—Ä–æ–≥–Ω–æ–∑—ã > 75% (–≤—ã—Å–æ–∫–∏–π ROI)
2. **–£–º–µ—Ä–µ–Ω–Ω–∞—è:** –ü—Ä–æ–≥–Ω–æ–∑—ã > 65% (–±–∞–ª–∞–Ω—Å —Ä–∏—Å–∫–∞)
3. **–ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è:** –ü—Ä–æ–≥–Ω–æ–∑—ã > 55% (–±–æ–ª—å—à–µ —Å—Ç–∞–≤–æ–∫)

## üî¨ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µdet–∞–ª–∏

### –ê–ª–≥–æ—Ä–∏—Ç–º—ã –∞–Ω—Å–∞–º–±–ª—è:

1. **LightGBM:**
   - n_estimators=300, learning_rate=0.05
   - max_depth=8, num_leaves=31
   - –í–µ—Å –≤ –∞–Ω—Å–∞–º–±–ª–µ: 24.83%

2. **XGBoost:**
   - n_estimators=300, learning_rate=0.05
   - max_depth=7, subsample=0.8
   - –í–µ—Å –≤ –∞–Ω—Å–∞–º–±–ª–µ: 25.00%

3. **CatBoost:**
   - iterations=300, learning_rate=0.05
   - depth=7, l2_leaf_reg=3
   - –í–µ—Å –≤ –∞–Ω—Å–∞–º–±–ª–µ: 25.27%

4. **Random Forest:**
   - n_estimators=200, max_depth=15
   - min_samples_split=10
   - –í–µ—Å –≤ –∞–Ω—Å–∞–º–±–ª–µ: 24.91%

### Weighted Voting:

–§–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑ = Œ£ (proba_i √ó weight_i)

–í–µ—Å–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ AUC –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏:
```
weight_i = AUC_i / Œ£(AUC_all)
```

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞ (428 –º–∞—Ç—á–µ–π):

```
              precision    recall  f1-score   support

   Under 2.5       0.69      0.67      0.68       212
    Over 2.5       0.68      0.71      0.70       216

    accuracy                           0.69       428
   macro avg       0.69      0.69      0.69       428
weighted avg       0.69      0.69      0.69       428
```

### Cross-validation (5-fold):

- –°—Ä–µ–¥–Ω—è—è —Ç–æ—á–Ω–æ—Å—Ç—å: 68.5% (¬±2.1%)
- ROC-AUC: 81.1% (¬±1.8%)

## üöß –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] –î–æ–±–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ —Ç—Ä–∞–≤–º–∞—Ö –∏–≥—Ä–æ–∫–æ–≤
- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–≥–æ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–∫—Ç–æ—Ä (—Ç—É—Ä–Ω–∏—Ä–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞)
- [ ] –°—Ç—ç–∫–∏–Ω–≥ –º–æ–¥–µ–ª–µ–π (meta-learning)
- [ ] Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- [ ] A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —Å—Ç–∞–≤–æ–∫

## üìù –õ–æ–≥–∏ –æ–±—É—á–µ–Ω–∏—è

–í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤:
- `ml/models/` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
- –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
- Classification reports

## ü§ù –í–∫–ª–∞–¥

–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–ª–∏ –º–æ–¥–µ–ª–µ–π:
1. –û–±–Ω–æ–≤–∏—Ç–µ `advanced_features.py`
2. –î–æ–±–∞–≤—å—Ç–µ –º–æ–¥–µ–ª—å –≤ `train_ensemble.py`
3. –û–±–Ω–æ–≤–∏—Ç–µ —ç—Ç–æ—Ç README
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `compare_models.py`

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - GoalPredictor.AI
