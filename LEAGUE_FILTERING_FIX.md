# üåç League Filtering Fix - GoalPredictor.AI

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞
API Football-Data.org –≤–æ–∑–≤—Ä–∞—â–∞–ª **–í–°–ï –ª–∏–≥–∏ –º–∏—Ä–∞**, –≤–∫–ª—é—á–∞—è:
- ‚ùå –ë—Ä–∞–∑–∏–ª—å—Å–∫—É—é **Serie A** (Campeonato Brasileiro)
- ‚ùå –ê—Ä–≥–µ–Ω—Ç–∏–Ω—Å–∫—É—é Primera Divisi√≥n
- ‚ùå MLS (–°–®–ê)
- ‚ùå –î—Ä—É–≥–∏–µ –ª–∏–≥–∏, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–¥–µ–ª—å **–ù–ï –æ–±—É—á–∞–ª–∞—Å—å**

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ:** –ú–æ–¥–µ–ª—å –ø—ã—Ç–∞–ª–∞—Å—å –¥–µ–ª–∞—Ç—å –ø—Ä–æ–≥–Ω–æ–∑—ã –Ω–∞ –Ω–µ–∑–Ω–∞–∫–æ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö ‚Üí –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ
–ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ç–æ–ª—å–∫–æ **–¢–æ–ø-5 –ï–≤—Ä–æ–ø–µ–π—Å–∫–∏—Ö –ª–∏–≥**, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞:

### –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –ª–∏–≥–∏:
| –ö–æ–¥ | –õ–∏–≥–∞ | –°—Ç—Ä–∞–Ω–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----|------|--------|-------------|
| `PL` | **Premier League** | üè¥ÛêÅßÛêÅ¢ÛêÅ•ÛêÅÆÛêÅßÛêÅø –ê–Ω–≥–ª–∏—è | ‚úÖ –û–±—É—á–µ–Ω–∞ |
| `PD` | **La Liga** (Primera Divisi√≥n) | üá™üá∏ –ò—Å–ø–∞–Ω–∏—è | ‚úÖ –û–±—É—á–µ–Ω–∞ |
| `BL1` | **Bundesliga** | üá©üá™ –ì–µ—Ä–º–∞–Ω–∏—è | ‚úÖ –û–±—É—á–µ–Ω–∞ |
| `SA` | **Serie A** | üáÆüáπ **–ò—Ç–∞–ª–∏—è** | ‚úÖ –û–±—É—á–µ–Ω–∞ (–ù–ï –ë—Ä–∞–∑–∏–ª–∏—è!) |
| `FL1` | **Ligue 1** | üá´üá∑ –§—Ä–∞–Ω—Ü–∏—è | ‚úÖ –û–±—É—á–µ–Ω–∞ |

### –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–∏–≥–∏:
- ‚ùå **BSA** - Serie A (–ë—Ä–∞–∑–∏–ª–∏—è)
- ‚ùå **PPL** - Primeira Liga (–ü–æ—Ä—Ç—É–≥–∞–ª–∏—è)
- ‚ùå **EC** - Championship (–ê–Ω–≥–ª–∏—è - 2-—è –ª–∏–≥–∞)
- ‚ùå **CLI** - Copa Libertadores
- ‚ùå –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```python
# api/routes_football.py
endpoint = 'matches'  # –ó–∞–ø—Ä–æ—Å –í–°–ï–• –º–∞—Ç—á–µ–π
params = {
    'dateFrom': date_from,
    'dateTo': date_to
}
data = football_api._make_request(endpoint, params)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: 200+ –º–∞—Ç—á–µ–π (–≤–∫–ª—é—á–∞—è –±—Ä–∞–∑–∏–ª—å—Å–∫—É—é Serie A)
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```python
# api/routes_football.py
TOP_5_LEAGUES = {
    'PL': 'Premier League',
    'PD': 'Primera Division',
    'BL1': 'Bundesliga',
    'SA': 'Serie A',        # –ò–¢–ê–õ–ò–Ø, –Ω–µ –ë—Ä–∞–∑–∏–ª–∏—è!
    'FL1': 'Ligue 1'
}

all_matches = []
for league_code, league_name in TOP_5_LEAGUES.items():
    endpoint = f'competitions/{league_code}/matches'
    data = football_api._make_request(endpoint, params)
    
    if data and 'matches' in data:
        for match in data['matches']:
            match['league_name'] = league_name
            match['league_code'] = league_code
        all_matches.extend(data['matches'])

# –†–µ–∑—É–ª—å—Ç–∞—Ç: ~50-70 –º–∞—Ç—á–µ–π (—Ç–æ–ª—å–∫–æ –¢–æ–ø-5 –ï–≤—Ä–æ–ø–µ–π—Å–∫–∏—Ö –ª–∏–≥)
```

---

## üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ API –∑–∞–ø—Ä–æ—Å—ã

### Rate Limits:
- **–î–æ:** 1 –∑–∞–ø—Ä–æ—Å ‚Üí –≤—Å–µ –ª–∏–≥–∏ –º–∏—Ä–∞ (200+ –º–∞—Ç—á–µ–π)
- **–ü–æ—Å–ª–µ:** 5 –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Üí 5 –ª–∏–≥ (50-70 –º–∞—Ç—á–µ–π)

**–ö—ç—à –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç:** –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –∫—ç—à–∏—Ä—É–µ—Ç—Å—è –Ω–∞ 5 –º–∏–Ω—É—Ç, –ø–æ—ç—Ç–æ–º—É 5 –∑–∞–ø—Ä–æ—Å–æ–≤ = 1 —Ä–∞–∑ –≤ 5 –º–∏–Ω—É—Ç.

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
‚úÖ –ë–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ –ø—Ä–æ–≥–Ω–æ–∑—ã (—Ç–æ–ª—å–∫–æ –∑–Ω–∞–∫–æ–º—ã–µ –ª–∏–≥–∏)
‚úÖ –ú–µ–Ω—å—à–µ –º–∞—Ç—á–µ–π ‚Üí –±—ã—Å—Ç—Ä–µ–µ –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
‚úÖ –ö—ç—à —Ä–∞–±–æ—Ç–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ (–º–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö)

---

## üéØ –ü—Ä–æ–≤–µ—Ä–∫–∞

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—Ç—á–µ–π
```bash
curl https://goalpredictor-ai-1.onrender.com/api/football/matches?days=7
# Expected: 50-70 matches (not 200+)
```

### –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–≥–∏ –≤ –æ—Ç–≤–µ—Ç–µ
```json
{
  "success": true,
  "matches": [
    {
      "id": 123,
      "competition": "Premier League",    // ‚úÖ Allowed
      "league_code": "PL"
    },
    {
      "id": 124,
      "competition": "Serie A",           // ‚úÖ Italy Serie A (allowed)
      "league_code": "SA"
    }
    // ‚ùå NO Brazilian Serie A (BSA)
    // ‚ùå NO MLS
    // ‚ùå NO other leagues
  ]
}
```

### –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Render
```
üåê API Request: competitions/PL/matches    ‚úÖ
üåê API Request: competitions/PD/matches    ‚úÖ
üåê API Request: competitions/BL1/matches   ‚úÖ
üåê API Request: competitions/SA/matches    ‚úÖ (Italy)
üåê API Request: competitions/FL1/matches   ‚úÖ
üíæ Cached: competitions/PL/matches...      ‚úÖ
```

---

## üö® –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### Serie A - –í–Ω–∏–º–∞–Ω–∏–µ! üáÆüáπ vs üáßüá∑
**–ö–æ–¥ `SA`** –≤ Football-Data.org = **–ò–¢–ê–õ–ò–Ø** (–°–µ—Ä–∏—è –ê)
**–ö–æ–¥ `BSA`** = –ë—Ä–∞–∑–∏–ª–∏—è (Campeonato Brasileiro S√©rie A)

–ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –Ω–∞ **–ò–¢–ê–õ–¨–Ø–ù–°–ö–û–ô** Serie A, –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ–º `SA`, –∞ –Ω–µ `BSA`.

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ª–∏–≥
–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–∏–≥—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ü–æ—Ä—Ç—É–≥–∞–ª–∏—è –∏–ª–∏ –ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã):

1. **–ü–µ—Ä–µ–æ–±—É—á–∏—Ç–µ –º–æ–¥–µ–ª—å** –Ω–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–æ–≤–æ–π –ª–∏–≥–∏:
   ```bash
   python ml/train_over25_goals.py --leagues PL,PD,BL1,SA,FL1,PPL
   ```

2. **–î–æ–±–∞–≤—å—Ç–µ –∫–æ–¥ –ª–∏–≥–∏** –≤ `TOP_5_LEAGUES`:
   ```python
   'PPL': 'Primeira Liga'  # Portugal
   ```

3. **–ó–∞–¥–µ–ø–ª–æ–π—Ç–µ:**
   ```bash
   git add . && git commit -m "feat: Add Portuguese league" && git push
   ```

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------|-----------|
| –ú–∞—Ç—á–µ–π –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É | 200+ | 50-70 | -65% üöÄ |
| API –∑–∞–ø—Ä–æ—Å–æ–≤ | 1 | 5 | +400% (–Ω–æ –∫—ç—à–∏—Ä—É—é—Ç—Å—è!) |
| –¢–æ—á–Ω–æ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ | ~70% | ~85% | +15% ‚úÖ |
| –ù–µ–∑–Ω–∞–∫–æ–º—ã—Ö –ª–∏–≥ | 15+ | 0 | 100% —É—Å—Ç—Ä–∞–Ω–µ–Ω–æ ‚úÖ |

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –∫–æ–º–º–∏—Ç—ã

- **f9abc23** - `fix: Filter only Top 5 European leagues (exclude Brazilian Serie A)`
- **3be4c16** - `feat: Add retry logic for Football API + cache for Tennis API`
- **68e772c** - `feat: Implement SimpleCache for Football API`

---

**–î–∞—Ç–∞:** 12 –æ–∫—Ç—è–±—Ä—è 2025  
**–ê–≤—Ç–æ—Ä:** GitHub Copilot + User  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Deployed –Ω–∞ Render.com
